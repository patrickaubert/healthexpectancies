tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex))
lionglets[[an]] <- tab
}
FRInseeMortalityrates <- do.call("rbind", lionglets)
View(FRInseeMortalityrates)
View(FRInseeMortalityrates)
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
year = as.numeric(year))
lionglets[[an]] <- tab
}
FRInseeMortalityrates <- do.call("rbind", lionglets)
View(FRInseeMortalityrates)
View(FRInseeMortalityrates)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
onglets <- excel_sheets("data-raw/fm_t68.xlsx")
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
FRInseeMortalityrates <- do.call("rbind", lionglets)
View(FRInseeMortalityrates)
View(FRInseeMortalityrates)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
devtools::load_all()
devtools::document()
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
View(FRInseeMortalityrates)
View(FRInseeMortalityrates)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
View(FRInseeMortalityrates)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
devtools::document()
devtools::load_all()
devtools::load_all()
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
library(readxl)
library(tidyverse)
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
unique(FRInseeMortalityrates$age)
truc <- FRInseeMortalityrates %>%filter(!grepl("^[[:digit:]]+$",age))
View(truc)
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2011 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
unique(FRInseeMortalityrates$age)
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2011 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
age = as.numeric(age),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
unique(FrInseeMortalityrates$age)
unique(FRInseeMortalityrates$age)
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
library(usethis)
library(pkgdown)
usethis::use_pkgdown()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
build_site()
library(pkgdown)
build_site()
build_site()
build_site()
build_site()
build_site()
library(pkgdown)
build_site()
build_site()
library(readxl)
library(tidyverse)
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2011 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
path,
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
age = as.numeric(age),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
View(FRInseeMortalityrates)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
library(devtools)
load_all()
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2011 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
path,
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
age = as.numeric(age),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
library(readxl)
library(tidyverse)
library(devtools)
devtools::load_all()
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2011 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
path,
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
age = as.numeric(age),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
View(FRInseeMortalityrates)
View(FRInseeMortalityrates)
FRInseePopulation <- bind_rows(
read_csv2("data-raw/donnees_pyramide_act") %>% mutate(geo="france",status="observed"),
read_csv2("data-raw/donnees_pyramide_proj") %>% mutate(geo="france",status="forecasted"),
read_csv2("data-raw/donnees_pyramide_act_fm") %>% mutate(geo="metropolitan france",status="observed"),
read_csv2("data-raw/donnees_pyramide_proj_fm") %>% mutate(geo="metropolitan france",status="forecasted")
)
FRInseePopulation <- bind_rows(
read_csv2("data-raw/donnees_pyramide_act.csv") %>% mutate(geo="france",status="observed"),
read_csv2("data-raw/donnees_pyramide_proj.csv") %>% mutate(geo="france",status="forecasted"),
read_csv2("data-raw/donnees_pyramide_act_fm.csv") %>% mutate(geo="metropolitan france",status="observed"),
read_csv2("data-raw/donnees_pyramide_proj_fm.csv") %>% mutate(geo="metropolitan france",status="forecasted")
)
FRInseePopulation <- bind_rows(
read_csv2("data-raw/donnees_pyramide_act.csv") %>% mutate(geo="france",status="observed"),
read_csv2("data-raw/donnees_pyramide_proj.csv") %>% mutate(geo="france",status="forecasted"),
read_csv2("data-raw/donnees_pyramide_act_fm.csv") %>% mutate(geo="metropolitan france",status="observed"),
read_csv2("data-raw/donnees_pyramide_proj_fm.csv") %>% mutate(geo="metropolitan france",status="forecasted") %>%
mutate(SEXE = recode(as.character(SEXE), "1"="M", "2"="F"))
)
View(FRInseePopulation)
View(FRInseeMortalityrates)
View(FRInseePopulation)
FRInseePopulation <- bind_rows(
read_csv2("data-raw/donnees_pyramide_act.csv") %>% mutate(geo="france"),
read_csv2("data-raw/donnees_pyramide_act_fm.csv") %>% mutate(geo="metropolitan france")  )  %>%
rename(year = ANNEE,
sex = SEXE,
popx = POP,
age0101 = AGE) %>%
mutate(year = as.numeric(year),
age0101 = as.numeric(age0101),
sex = as.factor(sex),
geo = as.factor(geo))
View(FRInseePopulation)
View(FRInseePopulation)
min(FRInseePopulation$year)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
build()
check()
build()
load_all()
runExample()
library(pkgdown)
build_site()
