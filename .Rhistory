year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
View(tab)
View(tab)
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep] %>% filter(!is.na(age))
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex))
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
year
cases
colkeep
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
View(tab)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex))
View(tab)
View(tab)
onglets <- excel_sheets("data-raw/fm_t68.xlsx")
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex))
}
onglets <- excel_sheets("data-raw/fm_t68.xlsx")
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex))
lionglets[[an]] <- tab
}
FRInseeMortalityrates <- do.call("rbind", lionglets)
View(FRInseeMortalityrates)
View(FRInseeMortalityrates)
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
year = as.numeric(year))
lionglets[[an]] <- tab
}
FRInseeMortalityrates <- do.call("rbind", lionglets)
View(FRInseeMortalityrates)
View(FRInseeMortalityrates)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
onglets <- excel_sheets("data-raw/fm_t68.xlsx")
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
FRInseeMortalityrates <- do.call("rbind", lionglets)
View(FRInseeMortalityrates)
View(FRInseeMortalityrates)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
devtools::load_all()
devtools::document()
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
View(FRInseeMortalityrates)
View(FRInseeMortalityrates)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
View(FRInseeMortalityrates)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
devtools::document()
devtools::load_all()
devtools::load_all()
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
library(readxl)
library(tidyverse)
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2010 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
unique(FRInseeMortalityrates$age)
truc <- FRInseeMortalityrates %>%filter(!grepl("^[[:digit:]]+$",age))
View(truc)
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2011 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
unique(FRInseeMortalityrates$age)
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2011 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
"data-raw/fm_t68.xlsx",
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
age = as.numeric(age),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
unique(FrInseeMortalityrates$age)
unique(FRInseeMortalityrates$age)
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
library(usethis)
library(pkgdown)
usethis::use_pkgdown()
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
build_site()
library(pkgdown)
build_site()
build_site()
build_site()
build_site()
build_site()
library(pkgdown)
build_site()
build_site()
library(readxl)
library(tidyverse)
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2011 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
path,
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
age = as.numeric(age),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
View(FRInseeMortalityrates)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
library(devtools)
load_all()
mr_fr <- function(path) {
onglets <- excel_sheets(path)
lionglets <- list()
for (an in 1:NROW(onglets)) {
year <- onglets[an]
cases <- case_when(year>=2012 ~ "A4:J109",
year>=2011 ~ "A12:J119",
year>=1990 ~ "A12:J114",
year>=1977 ~ "A12:G114")
colkeep <- c(1,3,6,9)
colnames <- c("age","male","female","all")
tab <- read_excel(
path,
sheet = year,
range = cases
)
colkeep <- colkeep[colkeep<=ncol(tab)]
tab <- tab[,colkeep]
names(tab) <- colnames[1:ncol(tab)]
tab <- tab %>%
filter(!is.na(age)) %>%
pivot_longer(cols=-c("age"),names_to="sex",values_to="qx") %>%
mutate(qx = qx/100000,
sex = as.factor(sex),
age = as.numeric(age),
year = as.numeric(year)-1)
lionglets[[an]] <- tab
}
return( do.call("rbind", lionglets) )
}
FRInseeMortalityrates <- rbind(
mr_fr("data-raw/fe_t68.xlsx") %>% mutate(geo = "france"),
mr_fr("data-raw/fm_t68.xlsx") %>% mutate(geo = "metropolitan france")
)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
sullivan,
description_sullivan,
overwrite = T)
