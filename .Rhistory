filter(age %in% c( unique(tabref$age))) %>% ###
left_join(tabDFLEref[,c(vardim,varkeep)] , by = c(vardim) )
tabDFLEproj <- CompleteDFLEtable( tabproj )
View(tabDFLEproj)
tabDFLEref <- CompleteDFLEtable(tabref)
tabproj <- tabproj %>%
filter(age %in% c( unique(tabref$age))) %>% ###
left_join(tabDFLEref[,c(vardim,varkeep)] , by = c(vardim) )
View(tabproj)
projections <- prevalenceForecast( qmortref, qmortproj , input$optionProj,
includevars  = c("MeanDAx","MedianDAx","ModalDAx")) %>%
select(sex,age,year,ex,DFLEx,DLEx,pctDFLEx,pix,MeanDAx,MedianDAx,ModalDAx)
projections <- prevalenceForecast( qmortref, qmortproj , "cstDFLE",
includevars  = c("MeanDAx","MedianDAx","ModalDAx")) %>%
select(sex,age,year,ex,DFLEx,DLEx,pctDFLEx,pix,MeanDAx,MedianDAx,ModalDAx)
projections <- prevalenceForecast( qmortref, qmortproj , "cstDFLE",
includevars  = c("MeanDAx","MedianDAx","ModalDAx"))
tabref<- qmortref
tabproj <-qmortproj
vardim <- intersect( c("sex","age","categ") , intersect(names(tabref), names(tabproj)) )
varkeep <- recode(hypo,
"cstDFLE" = "DFLEx",
"cstDLE" = "DLEx",
"cstPctDFLE" = "pctDFLEx",
"cstPrev" = "pix")
# DFLE, DLE and pctDFLE for reference year
tabDFLEref <- CompleteDFLEtable(tabref)
View(tabDFLEref)
tabproj <- tabproj %>%
filter(age %in% c( unique(tabref$age))) %>% ###
left_join(tabDFLEref[,c(vardim,varkeep)] , by = c(vardim) )
View(tabproj)
tabDFLEproj <- CompleteDFLEtable( tabproj )
View(tabDFLEproj)
View(tabDFLEproj)
load_all()
tabDFLEproj <- CompleteDFLEtable( tabproj )
View(tabDFLEproj)
projections <- prevalenceForecast( qmortref, qmortproj , "cstDFLE",
includevars  = c("MeanDAx","MedianDAx","ModalDAx")) %>%
select(sex,age,year,ex,DFLEx,DLEx,pctDFLEx,pix,MeanDAx,MedianDAx,ModalDAx)
runApp('inst/shiny-examples/projprevalence')
runApp('inst/shiny-examples/projprevalence')
rsconnect::deployApp(appDir = "C:/Users/PA/Documents/R/Projets/healthexpectancies/inst/shiny-examples/projprevalence", server = "shinyapps.io")
runExample()
rsconnect::deployApp(appDir = "C:/Users/PA/Documents/R/Projets/healthexpectancies/inst/shiny-examples/projprevalence", server = "shinyapps.io")
sessionInfo()
install()
check()
rsconnect::deployApp(appDir = "C:/Users/PA/Documents/R/Projets/healthexpectancies/inst/shiny-examples/projprevalence", server = "shinyapps.io")
install.packages("rsconnect")
install.packages("rsconnect")
rsconnect::deployApp(appDir = "C:/Users/PA/Documents/R/Projets/healthexpectancies/inst/shiny-examples/projprevalence", server = "shinyapps.io")
Y
install.packages("shiny")
shiny::runApp('inst/shiny-examples/projprevalence')
rsconnect::deployApp(appDir = "C:/Users/PA/Documents/R/Projets/healthexpectancies/inst/shiny-examples/projprevalence", server = "shinyapps.io")
runApp('inst/shiny-examples/projprevalence')
rsconnect::appDependencies()
rsconnect::deployApp(appDir = "C:/Users/PA/Documents/R/Projets/healthexpectancies/inst/shiny-examples/projprevalence", server = "shinyapps.io")
build()
options('repos')
build_package()
library(devtools)
options('repos')
build()
options('repos')
rsconnect::deployApp(appDir = "C:/Users/PA/Documents/R/Projets/healthexpectancies/inst/shiny-examples/projprevalence", server = "shinyapps.io")
devtools::install_github()
sessionInfo()
devtools::install()
rsconnect::getAccountInfo()
setRepositories("https://github.com/patrickaubert/healthexpectancies")
setRepositories("https://github.com/patrickaubert/")
options("repos")
?setRepositories
setRepositories(addURLs="https://github.com/patrickaubert/")
setRepositories(addURLs="https://github.com/")
options("repos")
rsconnect::deployApp(appDir = "C:/Users/PA/Documents/R/Projets/healthexpectancies/inst/shiny-examples/projprevalence", server = "shinyapps.io")
load_all()
rsconnect::deployApp(appDir = "C:/Users/PA/Documents/R/Projets/healthexpectancies/inst/shiny-examples/projprevalence", server = "shinyapps.io")
rsconnect::deployApp(appDir = "C:/Users/PA/Documents/R/Projets/healthexpectancies/inst/shiny-examples/projprevalence", server = "shinyapps.io")
library(devtools)
load_all()
library(devtools)
library(readxl)
library(tidyverse)
view(FRInseeMortalityrates)
max(FRInseeMortalityrates$year)
qmort_t69 <- bind_rows(
read.xlsx(
xlsxFile = "data-raw/fe_dod_quotients_mortalite.xlsx",
sheet =  "qmortf",
startRow = 5,
colNames = TRUE, skipEmptyRows = TRUE, skipEmptyCols = TRUE) %>%
filter(grepl("^[[:digit:]]{4}",Année)) %>%
pivot_longer(cols=-"Année",names_to="age",values_to="qx") %>%
mutate(sex = "female"),
read.xlsx(
xlsxFile = "data-raw/fe_dod_quotients_mortalite.xlsx",
sheet =  "qmorth",
startRow = 5,
colNames = TRUE, skipEmptyRows = TRUE, skipEmptyCols = TRUE) %>%
filter(grepl("^[[:digit:]]{4}",Année)) %>%
pivot_longer(cols=-"Année",names_to="age",values_to="qx") %>%
mutate(sex = "male")
) %>%
rename(year=Année) %>%
mutate(age = str_extract(age,"^[[:digit:]]+") %>% as.numeric(),
year= as.numeric(year),
qx = qx/100000)
library(openxlsx)
qmort_t69 <- bind_rows(
read.xlsx(
xlsxFile = "data-raw/fe_dod_quotients_mortalite.xlsx",
sheet =  "qmortf",
startRow = 5,
colNames = TRUE, skipEmptyRows = TRUE, skipEmptyCols = TRUE) %>%
filter(grepl("^[[:digit:]]{4}",Année)) %>%
pivot_longer(cols=-"Année",names_to="age",values_to="qx") %>%
mutate(sex = "female"),
read.xlsx(
xlsxFile = "data-raw/fe_dod_quotients_mortalite.xlsx",
sheet =  "qmorth",
startRow = 5,
colNames = TRUE, skipEmptyRows = TRUE, skipEmptyCols = TRUE) %>%
filter(grepl("^[[:digit:]]{4}",Année)) %>%
pivot_longer(cols=-"Année",names_to="age",values_to="qx") %>%
mutate(sex = "male")
) %>%
rename(year=Année) %>%
mutate(age = str_extract(age,"^[[:digit:]]+") %>% as.numeric(),
year= as.numeric(year),
qx = qx/100000)
View(qmort_t69)
qmort_t69_all <- qmort_t69 %>%
mutate(qx=1-qx) %>%
arrange(year,sex,age) %>% group_by(year,sex) %>% mutate(qx=cumprod(qx)) %>% ungroup() %>%
select(-sex) %>% group_by(year,age) %>% summarise_all(mean) %>% ungroup()
qmort_t69_all <- qmort_t69_all %>%
left_join(qmort_t69_all %>% mutate(age=age+1) %>% rename(lqx=qx), by=c("year","age")) %>%
mutate(qx = ifelse(age==0,1-qx,1-qx/lqx),
sex = "all") %>%
select(-lqx)
qmort_t69 <- bind_rows( qmort_t69 , qmort_t69_all)
qmort_t69 <- bind_rows(
read.xlsx(
xlsxFile = "data-raw/fe_dod_quotients_mortalite.xlsx",
sheet =  "qmortf",
startRow = 5,
colNames = TRUE, skipEmptyRows = TRUE, skipEmptyCols = TRUE) %>%
filter(grepl("^[[:digit:]]{4}",Année)) %>%
pivot_longer(cols=-"Année",names_to="age",values_to="qx") %>%
mutate(sex = "female"),
read.xlsx(
xlsxFile = "data-raw/fe_dod_quotients_mortalite.xlsx",
sheet =  "qmorth",
startRow = 5,
colNames = TRUE, skipEmptyRows = TRUE, skipEmptyCols = TRUE) %>%
filter(grepl("^[[:digit:]]{4}",Année)) %>%
pivot_longer(cols=-"Année",names_to="age",values_to="qx") %>%
mutate(sex = "male")
) %>%
rename(year=Année) %>%
mutate(age = str_extract(age,"^[[:digit:]]+") %>% as.numeric(),
year= as.numeric(year),
qx = qx/100000)
# correction pour tenir compte du fait qu'il s'agit de l'âge atteint en fin d'année => on considère que les décès à l'âge A au 31/12 se répartissent pour moitié entre les âges A-1 et 1 en année révolue
qmort_t69 <- bind_rows(
qmort_t69 %>% mutate(qx=qx/2,age=pmax(0,age-1)),
qmort_t69 %>% mutate(qx=qx/2)
) %>%
group_by(year,sex,age) %>% summarise_all(sum) %>% ungroup()
# ajout des quotients de mortalité pour l'ensemble des sexes, en faisant l'hypothèse d'un partage 50/50 d'hommes et de femmes à la naissance
qmort_t69_all <- qmort_t69 %>%
mutate(qx=1-qx) %>%
arrange(year,sex,age) %>% group_by(year,sex) %>% mutate(qx=cumprod(qx)) %>% ungroup() %>%
select(-sex) %>% group_by(year,age) %>% summarise_all(mean) %>% ungroup()
qmort_t69_all <- qmort_t69_all %>%
left_join(qmort_t69_all %>% mutate(age=age+1) %>% rename(lqx=qx), by=c("year","age")) %>%
mutate(qx = ifelse(age==0,1-qx,1-qx/lqx),
sex = "all") %>%
select(-lqx)
qmort_t69 <- bind_rows( qmort_t69 , qmort_t69_all)
qmort_t69 <- bind_rows(
read.xlsx(
xlsxFile = "data-raw/fe_dod_quotients_mortalite.xlsx",
sheet =  "qmortf",
startRow = 5,
colNames = TRUE, skipEmptyRows = TRUE, skipEmptyCols = TRUE) %>%
filter(grepl("^[[:digit:]]{4}",Année)) %>%
pivot_longer(cols=-"Année",names_to="age",values_to="qx") %>%
mutate(sex = "female"),
read.xlsx(
xlsxFile = "data-raw/fe_dod_quotients_mortalite.xlsx",
sheet =  "qmorth",
startRow = 5,
colNames = TRUE, skipEmptyRows = TRUE, skipEmptyCols = TRUE) %>%
filter(grepl("^[[:digit:]]{4}",Année)) %>%
pivot_longer(cols=-"Année",names_to="age",values_to="qx") %>%
mutate(sex = "male")
) %>%
rename(year=Année) %>%
mutate(age = str_extract(age,"^[[:digit:]]+") %>% as.numeric(),
year= as.numeric(year),
qx = qx/100000)
# correction pour tenir compte du fait qu'il s'agit de l'âge atteint en fin d'année => on considère que les décès à l'âge A au 31/12 se répartissent pour moitié entre les âges A-1 et 1 en année révolue
qmort_t69_bis <- bind_rows(
qmort_t69 %>% mutate(qx=qx/2,age=pmax(0,age-1)),
qmort_t69 %>% mutate(qx=qx/2)
) %>%
group_by(year,sex,age) %>% summarise_all(sum) %>% ungroup()
qmort_t69 <- bind_rows(
qmort_t69 %>% mutate(def.age = "age at end of year"),
qmort_t69_bis %>% mutate(def.age = "current age (approx)")
)
View(qmort_t69)
qmort_t69 <- bind_rows(
read.xlsx(
xlsxFile = "data-raw/fe_dod_quotients_mortalite.xlsx",
sheet =  "qmortf",
startRow = 5,
colNames = TRUE, skipEmptyRows = TRUE, skipEmptyCols = TRUE) %>%
filter(grepl("^[[:digit:]]{4}",Année)) %>%
pivot_longer(cols=-"Année",names_to="age",values_to="qx") %>%
mutate(sex = "female"),
read.xlsx(
xlsxFile = "data-raw/fe_dod_quotients_mortalite.xlsx",
sheet =  "qmorth",
startRow = 5,
colNames = TRUE, skipEmptyRows = TRUE, skipEmptyCols = TRUE) %>%
filter(grepl("^[[:digit:]]{4}",Année)) %>%
pivot_longer(cols=-"Année",names_to="age",values_to="qx") %>%
mutate(sex = "male")
) %>%
rename(year=Année) %>%
mutate(age = str_extract(age,"^[[:digit:]]+") %>% as.numeric(),
year= as.numeric(year),
qx = qx/100000)
# correction pour tenir compte du fait qu'il s'agit de l'âge atteint en fin d'année => on considère que les décès à l'âge A au 31/12 se répartissent pour moitié entre les âges A-1 et 1 en année révolue
qmort_t69_bis <- bind_rows(
qmort_t69 %>% mutate(qx=qx/2,age=pmax(0,age-1)),
qmort_t69 %>% mutate(qx=qx/2)
) %>%
group_by(year,sex,age) %>% summarise_all(sum) %>% ungroup()
qmort_t69 <- bind_rows(
qmort_t69 %>% mutate(def.age = "age at end of year"),
qmort_t69_bis %>% mutate(def.age = "current age (approx)")
) %>%
mutate(def.age = as.factor(def.age))
qmort_t69_all <- qmort_t69 %>%
mutate(qx=1-qx) %>%
arrange(year,sex,def.age,age) %>% group_by(year,sex,def.age) %>% mutate(qx=cumprod(qx)) %>% ungroup() %>%
select(-sex) %>% group_by(year,age) %>% summarise_all(mean) %>% ungroup()
qmort_t69_all <- qmort_t69_all %>%
left_join(qmort_t69_all %>% mutate(age=age+1) %>% rename(lqx=qx), by=c("year","age")) %>%
mutate(qx = ifelse(age==0,1-qx,1-qx/lqx),
sex = "all") %>%
select(-lqx)
qmort_t69_all <- qmort_t69 %>%
mutate(qx=1-qx) %>%
arrange(year,sex,def.age,age) %>% group_by(year,sex,def.age) %>% mutate(qx=cumprod(qx)) %>% ungroup() %>%
select(-sex) %>% group_by(year,age) %>% summarise_all(mean) %>% ungroup()
qmort_t69_all <- qmort_t69_all %>%
left_join(qmort_t69_all %>% mutate(age=age+1) %>% rename(lqx=qx), by=c("year","age","def.age")) %>%
mutate(qx = ifelse(age==0,1-qx,1-qx/lqx),
sex = "all") %>%
select(-lqx)
qmort_t69_all <- qmort_t69 %>%
mutate(qx=1-qx) %>%
arrange(year,sex,def.age,age) %>% group_by(year,sex,def.age) %>% mutate(qx=cumprod(qx)) %>% ungroup() %>%
select(-sex) %>% group_by(year,age) %>% summarise_all(mean) %>% ungroup()
qmort_t69_all <- qmort_t69_all %>%
left_join(qmort_t69_all %>% mutate(age=age+1) %>% rename(lqx=qx), by=c("year","age","def.age")) %>%
mutate(qx = ifelse(age==0,1-qx,1-qx/lqx),
sex = "all") %>%
select(-lqx)
View(qmort_t69_all)
View(qmort_t69_all)
qmort_t69_all <- qmort_t69 %>%
mutate(qx=1-qx) %>%
arrange(year,sex,def.age,age) %>% group_by(year,sex,def.age) %>% mutate(qx=cumprod(qx)) %>% ungroup() %>%
select(-sex) %>% group_by(year,def.age,age) %>% summarise_all(mean) %>% ungroup()
qmort_t69_all <- qmort_t69_all %>%
left_join(qmort_t69_all %>% mutate(age=age+1) %>% rename(lqx=qx), by=c("year","age","def.age")) %>%
mutate(qx = ifelse(age==0,1-qx,1-qx/lqx),
sex = "all") %>%
select(-lqx)
View(qmort_t69_all)
View(qmort_t69_all)
qmort_t69 <- bind_rows( qmort_t69 , qmort_t69_all)
FRInseeMortalityrates_t69 <- qmort_t69
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseeMortalityrates_t69,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
FRGaliEUSilc,
sullivan,
description_sullivan,
overwrite = T)
url_t69 <- "https://www.insee.fr/fr/statistiques/fichier/6036439/fe_dod_quotients_mortalite.xlsx"
qmort_t69 <- bind_rows(
read.xlsx(
#xlsxFile = "data-raw/fe_dod_quotients_mortalite.xlsx",
xlsxFile = url_t69,
sheet = "Qmort-F", #"qmortf",
startRow = 5,
colNames = TRUE, skipEmptyRows = TRUE, skipEmptyCols = TRUE) %>%
filter(grepl("^[[:digit:]]{4}",Année)) %>%
pivot_longer(cols=-"Année",names_to="age",values_to="qx") %>%
mutate(sex = "female"),
read.xlsx(
#xlsxFile = "data-raw/fe_dod_quotients_mortalite.xlsx",
xlsxFile = url_t69,
sheet = "Qmort-H", #"qmorth",
startRow = 5,
colNames = TRUE, skipEmptyRows = TRUE, skipEmptyCols = TRUE) %>%
filter(grepl("^[[:digit:]]{4}",Année)) %>%
pivot_longer(cols=-"Année",names_to="age",values_to="qx") %>%
mutate(sex = "male")
) %>%
rename(year=Année) %>%
mutate(age = str_extract(age,"^[[:digit:]]+") %>% as.numeric(),
year= as.numeric(year),
qx = qx/100000)
View(qmort_t69_bis)
View(qmort_t69)
View(qmort_t69)
qmort_t69_bis <- bind_rows(
qmort_t69 %>% mutate(qx=qx/2,age=pmax(0,age-1)),
qmort_t69 %>% mutate(qx=qx/2)
) %>%
group_by(year,sex,age) %>% summarise_all(sum) %>% ungroup()
qmort_t69 <- bind_rows(
qmort_t69 %>% mutate(def.age = "age at end of year"),
qmort_t69_bis %>% mutate(def.age = "current age (approx)")
) %>%
mutate(def.age = as.factor(def.age))
qmort_t69_all <- qmort_t69 %>%
mutate(qx=1-qx) %>%
arrange(year,sex,def.age,age) %>% group_by(year,sex,def.age) %>% mutate(qx=cumprod(qx)) %>% ungroup() %>%
select(-sex) %>% group_by(year,def.age,age) %>% summarise_all(mean) %>% ungroup()
qmort_t69_all <- qmort_t69_all %>%
left_join(qmort_t69_all %>% mutate(age=age+1) %>% rename(lqx=qx), by=c("year","age","def.age")) %>%
mutate(qx = ifelse(age==0,1-qx,1-qx/lqx),
sex = "all") %>%
select(-lqx)
qmort_t69 <- bind_rows( qmort_t69 , qmort_t69_all)
FRInseeMortalityrates_t69 <- qmort_t69
qmort_t69_all <- qmort_t69 %>%
mutate(qx=1-qx) %>%
arrange(year,sex,def.age,age) %>% group_by(year,sex,def.age) %>% mutate(qx=cumprod(qx)) %>% ungroup() %>%
select(-sex) %>% group_by(year,def.age,age) %>% summarise_all(mean) %>% ungroup()
qmort_t69_all <- qmort_t69_all %>%
left_join(qmort_t69_all %>% mutate(age=age+1) %>% rename(lqx=qx), by=c("year","age","def.age")) %>%
mutate(qx = ifelse(age==0,1-qx,1-qx/lqx),
sex = "all") %>%
select(-lqx)
qmort_t69 <- bind_rows( qmort_t69 , qmort_t69_all)
FRInseeMortalityrates_t69 <- qmort_t69
View(FRInseeMortalityrates_t69)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseePopulationForecast2016,
FRInseeMortalityrates,
FRInseeMortalityrates_t69,
FRInseePopulation,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
FRGaliEUSilc,
sullivan,
description_sullivan,
overwrite = T)
document()
view(FRGaliEUSilc)
document()
library(devtools)
library(readxl)
library(openxlsx)
library(tidyverse)
load_all()
FRInseePopulationForecast2021 <- bind_rows(
read_csv2("data-raw/donnees_pyramide_act_2022.csv") %>% mutate(geo="france",type="observed"),
read_csv2("data-raw/donnees_pyramide_proj_2022.csv") %>% mutate(geo="france",type="forecasted")  )  %>%
rename(year = ANNEE,
sex = SEXE,
popx0101 = POP,
age0101 = AGE) %>%
mutate(year = as.numeric(year),
age0101 = as.numeric(age0101),
sex = as.factor(sex),
geo = as.factor(geo))
View(FRInseePopulationForecast2021)
View(FRInseePopulationForecast2021)
FRInseePopulationForecast2021 <- bind_rows(
read_csv2("data-raw/donnees_pyramide_act_2022.csv") %>% mutate(geo="france",type="observed"),
read_csv2("data-raw/donnees_pyramide_proj_2022.csv") %>% mutate(geo="france",type="forecasted")  )  %>%
rename(year = ANNEE,
sex = SEXE,
popx0101 = POP,
age0101 = AGE) %>%
mutate(year = as.numeric(year),
age0101 = as.numeric(age0101),
sex = as.factor(sex),
geo = as.factor(geo),
sex = recode(sex, "M" = "male", "F" = "female"))
View(FRInseePopulationForecast2021)
FRInseePopulationForecast2021 <- bind_rows(
read_csv2("data-raw/donnees_pyramide_act_2022.csv") %>% mutate(geo="france",type="observed"),
read_csv2("data-raw/donnees_pyramide_proj_2022.csv") %>% mutate(geo="france",type="forecasted")  )  %>%
rename(year = ANNEE,
sex = SEXE,
popx0101 = POP,
age0101 = AGE) %>%
mutate(year = as.numeric(year),
age0101 = as.numeric(age0101),
sex = as.factor(sex) %>% recode("M" = "male", "F" = "female"),
geo = as.factor(geo) )
FRInseePopulationForecast2021 <- bind_rows(
FRInseePopulationForecast2021,
FRInseePopulationForecast2021 %>%
select(-sex) %>%
group_by(year,geo) %>% summarise(sum) %>% ungroup() %>%
mutate(sex = "all")
)
FRInseePopulationForecast2021 <- bind_rows(
read_csv2("data-raw/donnees_pyramide_act_2022.csv") %>% mutate(geo="france",type="observed"),
read_csv2("data-raw/donnees_pyramide_proj_2022.csv") %>% mutate(geo="france",type="forecasted")  )  %>%
rename(year = ANNEE,
sex = SEXE,
popx0101 = POP,
age0101 = AGE) %>%
mutate(year = as.numeric(year),
age0101 = as.numeric(age0101),
sex = as.factor(sex) %>% recode("M" = "male", "F" = "female"),
geo = as.factor(geo) )
FRInseePopulationForecast2021 <- bind_rows(
FRInseePopulationForecast2021,
FRInseePopulationForecast2021 %>%
select(-sex) %>%
group_by(year,geo,age0101) %>% summarise(sum) %>% ungroup() %>%
mutate(sex = "all")
)
FRInseePopulationForecast2021 <- bind_rows(
read_csv2("data-raw/donnees_pyramide_act_2022.csv") %>% mutate(geo="france",type="observed"),
read_csv2("data-raw/donnees_pyramide_proj_2022.csv") %>% mutate(geo="france",type="forecasted")  )  %>%
rename(year = ANNEE,
sex = SEXE,
popx0101 = POP,
age0101 = AGE) %>%
mutate(year = as.numeric(year),
age0101 = as.numeric(age0101),
sex = as.factor(sex) %>% recode("M" = "male", "F" = "female"),
geo = as.factor(geo) )
FRInseePopulationForecast2021 <- bind_rows(
FRInseePopulationForecast2021,
FRInseePopulationForecast2021 %>%
select(-sex) %>%
group_by(year,geo,type,age0101) %>% summarise(sum) %>% ungroup() %>%
mutate(sex = "all")
)
FRInseePopulationForecast2021 <- bind_rows(
read_csv2("data-raw/donnees_pyramide_act_2022.csv") %>% mutate(geo="france",type="observed"),
read_csv2("data-raw/donnees_pyramide_proj_2022.csv") %>% mutate(geo="france",type="forecasted")  )  %>%
rename(year = ANNEE,
sex = SEXE,
popx0101 = POP,
age0101 = AGE) %>%
mutate(year = as.numeric(year),
age0101 = as.numeric(age0101),
sex = as.factor(sex) %>% recode("M" = "male", "F" = "female"),
geo = as.factor(geo) )
View(FRInseePopulationForecast2021)
FRInseePopulationForecast2021 <- bind_rows(
FRInseePopulationForecast2021,
FRInseePopulationForecast2021 %>%
select(-sex) %>%
group_by(year,geo,type,age0101) %>% summarise(sum) %>% ungroup() %>%
mutate(sex = "all")
)
truc <- FRInseePopulationForecast2021 %>%
select(-sex)
FRInseePopulationForecast2021 <- bind_rows(
FRInseePopulationForecast2021,
FRInseePopulationForecast2021 %>%
select(-sex) %>%
group_by(year,geo,type,age0101) %>% summarise_all(sum) %>% ungroup() %>%
mutate(sex = "all")
)
View(FRInseePopulationForecast2021)
usethis::use_data(FRInseeMortalityForecast2016,
FRInseeMortalityrates,
FRInseeMortalityrates_t69,
FRInseePopulation,
FRInseePopulationForecast2016,
FRInseePopulationForecast2021,
FRDreesVQSsurvey2014,
FRDreesAPA2017,
FRDreesAPA,
FRGaliEUSilc,
sullivan,
description_sullivan,
overwrite = T)
load_all()
build()
document()
build_site()
